<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 3.11.1"/><style data-styled="" data-styled-version="5.3.0">.ixfCJE{margin:25px 0;text-align:center;}/*!sc*/
data-styled.g2[id="stylesheet__Subtitle-sc-jbe1nk-1"]{content:"ixfCJE,"}/*!sc*/
.WbQyc{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:75px 20%;}/*!sc*/
@media only screen and (max-width:420px){.WbQyc{padding:25px 2%;}}/*!sc*/
@media only screen and (max-width:800px) and (min-width:420px){.WbQyc{padding:25px 10%;}}/*!sc*/
data-styled.g4[id="SiteLayoutstyle__ContentContainer-sc-17bo9rt-0"]{content:"WbQyc,"}/*!sc*/
.ilaYfY{background-color:transparent !important;height:100px;overflow:visible;box-shadow:none !important;}/*!sc*/
.ilaYfY::after{content:'';position:absolute;left:0;z-index:-1;width:100vw;background:url('/blog/images/navbar.svg');aspect-ratio:900/50;background-repeat:no-repeat;background-position:center;background-size:cover;}/*!sc*/
@media only screen and (max-width:1000px){.ilaYfY::after{aspect-ratio:600/50;}}/*!sc*/
@media only screen and (max-width:600px){.ilaYfY::after{aspect-ratio:300/50;}}/*!sc*/
data-styled.g5[id="SiteLayoutstyle__StyledNavbar-sc-17bo9rt-1"]{content:"ilaYfY,"}/*!sc*/
@media only screen and (max-width:420px){.eiPJnw{display:none;}}/*!sc*/
data-styled.g6[id="SiteLayoutstyle__StyledRightNavbarGroup-sc-17bo9rt-2"]{content:"eiPJnw,"}/*!sc*/
.cGJeeF{padding:10px;}/*!sc*/
data-styled.g7[id="SiteLayoutstyle__Link-sc-17bo9rt-3"]{content:"cGJeeF,"}/*!sc*/
.bwSNhY:hover{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g8[id="SiteLayoutstyle__BlogTitle-sc-17bo9rt-4"]{content:"bwSNhY,"}/*!sc*/
.cCEFpP{aspect-ratio:900/100;width:100vw;background-repeat:no-repeat;background-position:center;background-size:cover;}/*!sc*/
@media only screen and (max-width:600px){.cCEFpP{aspect-ratio:150/50;}}/*!sc*/
data-styled.g9[id="SiteLayoutstyle__Span-sc-17bo9rt-5"]{content:"cCEFpP,"}/*!sc*/
.bCEtmV{background-image:url('/blog/images/footer.svg');}/*!sc*/
data-styled.g10[id="SiteLayoutstyle__Footer-sc-17bo9rt-6"]{content:"bCEtmV,"}/*!sc*/
.epZggC{background-image:url('/blog/images/header.svg');}/*!sc*/
data-styled.g11[id="SiteLayoutstyle__Header-sc-17bo9rt-7"]{content:"epZggC,"}/*!sc*/
.eoOHaW{margin-bottom:25px;}/*!sc*/
data-styled.g17[id="BlogPoststyle__HeaderImg-sc-sbkfn9-0"]{content:"eoOHaW,"}/*!sc*/
</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/blog/favicon-32x32.png?v=472739dfb5857b1f659f4c4c6b4568d0" type="image/png"/><link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=472739dfb5857b1f659f4c4c6b4568d0"/><link as="script" rel="preload" href="/blog/webpack-runtime-989660260a8f6f123648.js"/><link as="script" rel="preload" href="/blog/framework-8dcaa89ad56a07169b97.js"/><link as="script" rel="preload" href="/blog/app-1314b861ed0bb07b6c47.js"/><link as="script" rel="preload" href="/blog/6278397b-fef80d2a20efbbaf73b7.js"/><link as="script" rel="preload" href="/blog/commons-58f96f9c41a01af360af.js"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-blog-post-jsx-cf647882aae575c41028.js"/><link as="fetch" rel="preload" href="/blog/page-data/2021/07/writing-a-native-ionic-plugin-for-capacitor/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="bp3-dark"><div class="SiteLayoutstyle__Span-sc-17bo9rt-5 SiteLayoutstyle__Header-sc-17bo9rt-7 cCEFpP epZggC"></div><div class="bp3-navbar bp3-fixed-top SiteLayoutstyle__StyledNavbar-sc-17bo9rt-1 ilaYfY"><div class="bp3-navbar-group bp3-align-left"><a href="https://jamesdhw.github.io" class="SiteLayoutstyle__Link-sc-17bo9rt-3 cGJeeF"><span icon="home" class="bp3-icon bp3-icon-home"><svg fill="white" data-icon="home" width="24" height="24" viewBox="0 0 20 20"><desc>home</desc><path d="M2 12v7c0 .55.45 1 1 1h5v-7h4v7h5c.55 0 1-.45 1-1v-7l-8-8-8 8zm17.71-2.71L17 6.59V3c0-.55-.45-1-1-1s-1 .45-1 1v1.59L10.71.3C10.53.11 10.28 0 10 0s-.53.11-.71.29l-9 9a1.003 1.003 0 001.42 1.42L10 2.41l8.29 8.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71z" fill-rule="evenodd"></path></svg></span></a><div class="bp3-navbar-divider"></div><a href="/blog" class="SiteLayoutstyle__BlogTitle-sc-17bo9rt-4 bwSNhY"><h2 class="bp3-heading stylesheet__Subtitle-sc-jbe1nk-1 ixfCJE">James&#x27; Blog ðŸš€</h2></a></div><div class="bp3-navbar-group bp3-align-right SiteLayoutstyle__StyledRightNavbarGroup-sc-17bo9rt-2 eiPJnw"><div class="bp3-navbar-divider"></div><a target="_blank" href="https://github.com/JamesDHW" class="SiteLayoutstyle__Link-sc-17bo9rt-3 cGJeeF"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:24px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;24&#x27; width=&#x27;24&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/blog/static/472739dfb5857b1f659f4c4c6b4568d0/eee53/GitHub.webp 6w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/30aa9/GitHub.webp 12w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/4e704/GitHub.webp 24w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/e78b1/GitHub.webp 48w" sizes="(min-width: 24px) 24px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 24px) 24px, 100vw" decoding="async" loading="lazy" data-src="/blog/static/472739dfb5857b1f659f4c4c6b4568d0/2391d/GitHub.png" data-srcset="/blog/static/472739dfb5857b1f659f4c4c6b4568d0/47ee7/GitHub.png 6w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/29278/GitHub.png 12w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/2391d/GitHub.png 24w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/fcdb9/GitHub.png 48w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="/blog/static/472739dfb5857b1f659f4c4c6b4568d0/eee53/GitHub.webp 6w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/30aa9/GitHub.webp 12w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/4e704/GitHub.webp 24w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/e78b1/GitHub.webp 48w" sizes="(min-width: 24px) 24px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 24px) 24px, 100vw" decoding="async" loading="lazy" src="/blog/static/472739dfb5857b1f659f4c4c6b4568d0/2391d/GitHub.png" srcSet="/blog/static/472739dfb5857b1f659f4c4c6b4568d0/47ee7/GitHub.png 6w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/29278/GitHub.png 12w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/2391d/GitHub.png 24w,/blog/static/472739dfb5857b1f659f4c4c6b4568d0/fcdb9/GitHub.png 48w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></a><a target="_blank" href="https://www.linkedin.com/in/jamesdhw/" class="SiteLayoutstyle__Link-sc-17bo9rt-3 cGJeeF"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:24px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;24&#x27; width=&#x27;24&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/eee53/LinkedIn.webp 6w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/30aa9/LinkedIn.webp 12w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/4e704/LinkedIn.webp 24w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/e78b1/LinkedIn.webp 48w" sizes="(min-width: 24px) 24px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 24px) 24px, 100vw" decoding="async" loading="lazy" data-src="/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/2391d/LinkedIn.png" data-srcset="/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/47ee7/LinkedIn.png 6w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/29278/LinkedIn.png 12w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/2391d/LinkedIn.png 24w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/fcdb9/LinkedIn.png 48w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/eee53/LinkedIn.webp 6w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/30aa9/LinkedIn.webp 12w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/4e704/LinkedIn.webp 24w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/e78b1/LinkedIn.webp 48w" sizes="(min-width: 24px) 24px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 24px) 24px, 100vw" decoding="async" loading="lazy" src="/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/2391d/LinkedIn.png" srcSet="/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/47ee7/LinkedIn.png 6w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/29278/LinkedIn.png 12w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/2391d/LinkedIn.png 24w,/blog/static/ccd0e9f542f1ea853760aa5d59189fb5/fcdb9/LinkedIn.png 48w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></a></div></div><div class="SiteLayoutstyle__ContentContainer-sc-17bo9rt-0 WbQyc"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained BlogPoststyle__HeaderImg-sc-sbkfn9-0 eoOHaW"><div style="max-width:800px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;196.75675675675677&#x27; width=&#x27;800&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXklEQVQY01WQvUtbYRTGf4kJ4tf1xquiBRdFQYS8IiUUBId2V9DFyfqB1kD8moRMDkJehUBTqAVBHIpTpKCCeiVRUWzBycXNwX/BTdN77ivXgOIDD5wznN/Dc1BaeHXmbY5nhbZrg3MmsFFqtvcesI+9toGrX3z9DS0fLUY3CdQUrcKJVkE4AsGxo7QklBY7njXBXqm0RLp+eNGGE5+Y631iq5Sv3n06ihX8lboLA5hQdT2M5BiPVHIPJCmrIgAMKe3nVUY+Ky0TSsus0pKMr0v/h11DzPUnrUPvxjr07uwTf4GiIfcPUgUW58/xE2MECemAZrWWge1Ky6DS0qoy0qD0ixu7c2I1uoZYwUzV7pduw9sl1zryJ8kbls8gVWR17hSz9JcNINzSAzP75cr0rhne/VILX5KCVRRsV/pq/jw6/Pwf77w30GFIX8LiBaFUgeFvBzhjOzC9R2j4OzwDm+2YnhA0WSYAAAAASUVORK5CYII=" alt=""/><picture><source type="image/avif" data-srcset="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/6b17e/thumbnail.avif 185w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/097b8/thumbnail.avif 370w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/3950a/thumbnail.avif 740w" sizes="(min-width: 740px) 740px, 100vw"/><source type="image/webp" data-srcset="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/4d5e6/thumbnail.webp 185w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/bb639/thumbnail.webp 370w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/4baf0/thumbnail.webp 740w" sizes="(min-width: 740px) 740px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 740px) 740px, 100vw" decoding="async" loading="lazy" data-src="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/821da/thumbnail.png" data-srcset="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/22719/thumbnail.png 185w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/b91c6/thumbnail.png 370w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/821da/thumbnail.png 740w" alt=""/></picture><noscript><picture><source type="image/avif" srcSet="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/6b17e/thumbnail.avif 185w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/097b8/thumbnail.avif 370w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/3950a/thumbnail.avif 740w" sizes="(min-width: 740px) 740px, 100vw"/><source type="image/webp" srcSet="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/4d5e6/thumbnail.webp 185w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/bb639/thumbnail.webp 370w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/4baf0/thumbnail.webp 740w" sizes="(min-width: 740px) 740px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 740px) 740px, 100vw" decoding="async" loading="lazy" src="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/821da/thumbnail.png" srcSet="/blog/static/4e65716d005262aaf11d4b16d7ab0d52/22719/thumbnail.png 185w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/b91c6/thumbnail.png 370w,/blog/static/4e65716d005262aaf11d4b16d7ab0d52/821da/thumbnail.png 740w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><h1 class="bp3-heading">Writing a native Ionic plugin for Capacitor in less than 30 minutes</h1><div><p><strong>TLDR:</strong> <em>When the pandemic first started, I decided to develop a contact-tracing mobile app. I was studying Computer Science at the time and decided to use the same cross-platform framework that we were using on our course - Ionic. I wanted to use Google's <a href="https://developers.google.com/nearby/messages/overview">Nearby Messages API</a> to share packets of information between iOS and Android devices via Bluetooth, but I couldn't find a plugin for this, so I decided to write my own!</em></p>
<p><strong>View commits: <a href="https://github.com/JamesDHW/IonicNativePlugin/commit/614b47fe1e54fe43540d3f6b98f0899949673be4">Android plugin</a> â†’ <a href="https://github.com/JamesDHW/IonicNativePlugin/commit/9bcffc1b029ed0422c136fc367e544b4585f9115">iOS plugin</a> â†’ <a href="https://github.com/JamesDHW/IonicNativePlugin/commit/63510c8cc83b570fb639de6573a28bad58b87a3f">Import native plugins</a>  â†’ <a href="https://github.com/JamesDHW/IonicNativePlugin/commit/3652b264b287b5c909633e16532225e4293763cb">Implementation</a></strong></p>
<p><a href="https://ionicframework.com/">Ionic</a> is a cross-platform mobile framework which allows you to develop an app using JavaScript/HTML/CSS and share this single implementation across different native devices. This Ionic project can then be compiled to native source code (Android/iOS) using Ionic's tool, <a href="https://capacitorjs.com/">Capacitor</a>.</p>
<p>Using a cross-platform framework like this to develop your mobile app is almost always a good idea, because it means you can maintain a single codebase which runs on both Android and iOS. This means you're not duplicating business logic across two different codebases in two different languages with two different teams (to be avoided).</p>
<p>If you're looking to write some native code in a cross-platform project but you're still deciding which framework to use, check out this <a href="https://blog.theodo.com/2020/04/react-native-bridge-module/">Theodo blog post</a> on React Native as well!</p>
<h1>Step 1 - Search for existing solutions</h1>
<p>Firstly, let's have a quick check that one of the <a href="https://capacitorjs.com/docs/apis">default plugins</a> doesn't do the job for us already.</p>
<p>Secondly, let's search through the <a href="https://github.com/capacitor-community">community plugins</a> to find the feature we're looking for.</p>
<p>No luck finding an existing plugin? Don't worry - let's move on to step 2!</p>
<h1>Step 2 - Start a new app with Ionic + Capacitor</h1>
<p>I'm starting a new project from scratch just to show you how it's done.</p>
<deckgo-highlight-code language="bash" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">npm install -g @ionic/cli

ionic start &lt;app-name&gt;
cd &lt;app-name&gt;
ionic serve &lt;-- you can serve your project on localhost</code>
        </deckgo-highlight-code>
<p>The <code class="language-text">/src</code> directory of our Ionic project holds the source code for our cross-platform app.</p>
<p>We can use Capacitor to compile this into two native projects:</p>
<deckgo-highlight-code language="bash" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">npm install @capacitor/cli @capacitor/core

npx cap init
npx cap add ios
npx cap add android</code>
        </deckgo-highlight-code>
<p>When we make changes to our <code class="language-text">/src</code> directory, we can apply those changes to our native projects by running <code class="language-text">npx ionic build &amp;&amp; npx cap copy</code>.</p>
<p>We now have our project set up and ready to add a custom plugin.</p>
<h1>Step 3 - Check the documentation</h1>
<p>Capacitor is well-documented and it's worth linking some references here to accompany this guide:</p>
<p><a href="https://capacitorjs.com/docs/android/custom-code">Getting started with Android</a></p>
<p><a href="https://capacitorjs.com/docs/plugins/android">Android reference</a></p>
<p><a href="https://capacitorjs.com/docs/ios/custom-code">Getting started with iOS</a></p>
<p><a href="https://capacitorjs.com/docs/plugins/ios">iOS reference</a></p>
<h1>Step 4 - Define a strategy</h1>
<p>There are three main steps to writing a plugin:</p>
<ol>
<li>(iOS &#x26; Android) Write a class in each native project to hold the native code we want to run (this is our plugin).</li>
<li>(iOS &#x26; Android) Register these classes inside the bridge of our native projects to expose the methods.</li>
<li>(Javascript - Ionic) Import and call the methods of our registered plugin.</li>
</ol>
<p>We should avoid duplicating code as much as much as possible (DRY), so all your business logic stays written in JavaScript, keeping the bare minimum written natively.</p>
<p>Your plugins should be narrow in scope (do one specific thing) - make sure to follow this philosophy and give your plugin a specific name ('Plugin' is a bad name!).</p>
<p>We have two main strategies for calling our plugins:</p>
<ul>
<li>An (asynchronous) method: we call some native method which we can <code class="language-text">await</code> in our business logic in Ionic.</li>
<li>Event listeners: define a listener in our business logic. Events can be triggered in our native code to pass payloads back to the business logic.</li>
</ul>
<p>If we are subscribing to a stream of events (expecting our method to resolve with multiple payloads over a longer time period e.g. geolocation/ Bluetooth updates), then event listeners are the appropriate way to handle our native calls.</p>
<h1>Step 5 - Write and register the Android plugin</h1>
<p>[<a href="https://github.com/JamesDHW/IonicNativePlugin/commit/614b47fe1e54fe43540d3f6b98f0899949673be4">View the commit</a>]</p>
<p>Open the <code class="language-text">/android</code> directory of your project in Android Studio.</p>
<p>In <code class="language-text">/app/src/main/java/../../..</code> (next to <code class="language-text">MainActivity.java</code>), we can create a new file (I'm calling mine <code class="language-text">IonicNativePluginExample.java</code>) and write a class which extends the Capacitor <code class="language-text">Plugin</code> class:</p>
<deckgo-highlight-code language="java" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">package /* &lt;package-name&gt; */; // e.g. io.ionic.starter

import com.getcapacitor.JSObject;
import com.getcapacitor.Plugin;
import com.getcapacitor.PluginCall;
import com.getcapacitor.PluginMethod;
import com.getcapacitor.annotation.CapacitorPlugin;

@CapacitorPlugin(name = &quot;IonicNativePluginExample&quot;)
public class IonicNativePluginExample extends Plugin {

    @PluginMethod
    public void NativeMethod(PluginCall call){
        JSObject result = new JSObject();
        result.put(&quot;message&quot;, &quot;Hello Android user!&quot;);
        call.resolve(result);
    }

    @PluginMethod
    public void NotifyListeners(PluginCall call){
        JSObject result = new JSObject();
        result.put(&quot;message&quot;, &quot;Hello Android user!&quot;);
        notifyListeners(&quot;EVENT_LISTENER_NAME&quot;, result);
    }

}</code>
        </deckgo-highlight-code>
<p>Next, we can register this plugin in <code class="language-text">MainActivity.java</code> where Capacitor initialises its bridge:</p>
<deckgo-highlight-code language="java" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">package /* &lt;package-name&gt; */; // e.g. io.ionic.starter

import android.os.Bundle;
import com.getcapacitor.BridgeActivity;

public class MainActivity extends BridgeActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        registerPlugin(IonicNativePluginExample.class);

    }
}</code>
        </deckgo-highlight-code>
<p>We can run our project like any other native Android project, by pressing the 'play' button in Android Studio.</p>
<p>If you're looking to develop in Kotlin - Android Studio comes with tooling to convert this Java class to Kotlin (right-click the file you want to convert).</p>
<p><strong>Note: you might need to edit the Gradle <code class="language-text">distributionUrl</code> to get the project build to succeed - there's an example in my repo <a href="https://github.com/JamesDHW/IonicNativePlugin/commit/e7abb66621ca0c0444cee55aa7f3d40a621eeef7">here</a>.</strong></p>
<h1>Step 6 - Write and register the iOS plugin</h1>
<p>[<a href="https://github.com/JamesDHW/IonicNativePlugin/commit/9bcffc1b029ed0422c136fc367e544b4585f9115">View the commit</a>]</p>
<p>Open the <code class="language-text">ios/App</code> directory of your project in Xcode.</p>
<p>In <code class="language-text">/App</code> (next to <code class="language-text">AppDelegate.swift</code>), we can right-click on the directory to create a new swift file (I'm calling mine <code class="language-text">IonicNativePluginExample.swift</code>). This will hold our plugin class with our <code class="language-text">IonicNativePluginExample</code> method.</p>
<deckgo-highlight-code language="swift" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">import Foundation
import Capacitor

@objc(IonicNativePluginExample)
public class IonicNativePluginExample: CAPPlugin {

	@objc func NativeMethod(_ call: CAPPluginCall) {
		call.resolve([&quot;message&quot;: &quot;Hello iOS user!&quot;])
	}

	@objc func NotifyListeners(_ call: CAPPluginCall) {
		self.notifyListeners(
			&quot;EVENT_LISTENER_NAME&quot;,
			data: [&quot;message&quot;: &quot;Hello iOS user!&quot;]
		)
	}

}</code>
        </deckgo-highlight-code>
<p>Next, we must register our plugin in a new Objective-C file called <code class="language-text">IonicNativePluginExample.m</code> (same name as our plugin file but with a <code class="language-text">.m</code> extension). When prompted by Xcode, create a Bridging Header file (which is an empty file called <code class="language-text">App-Bridging-Header.h</code>), then register the plugin like so:</p>
<deckgo-highlight-code language="objectivec" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">#import &lt;Foundation/Foundation.h&gt;
#import &lt;Capacitor/Capacitor.h&gt;

CAP_PLUGIN(IonicNativePluginExample, &quot;IonicNativePluginExample&quot;,
           CAP_PLUGIN_METHOD(NativeMethod, CAPPluginReturnPromise);
           CAP_PLUGIN_METHOD(NotifyListeners, CAPPluginReturnPromise);
)</code>
        </deckgo-highlight-code>
<p>We can run our project like any other native iOS project, by pressing the 'play' button in Xcode.</p>
<h1>Step 7 - Import and call our plugin in Ionic</h1>
<p>[<a href="https://github.com/JamesDHW/IonicNativePlugin/commit/63510c8cc83b570fb639de6573a28bad58b87a3f">View the commit</a>]</p>
<p>Finally, we can now access the plugins we have written from our Ionic project. I've created a <code class="language-text">/plugins</code> directory to export mine from. We import <code class="language-text">registerPlugin</code> from Capacitor to find the plugin we have registered in Android and iOS:</p>
<deckgo-highlight-code language="jsx" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">import { registerPlugin, Plugin } from &quot;@capacitor/core&quot;;

// we can take advantage of TypeScript here!
interface NativePluginInterface extends Plugin {
  NativeMethod: () =&gt; Promise&lt;Record&lt;&quot;message&quot;, string&gt;&gt;;
  NotifyListeners: () =&gt; Promise&lt;void&gt;;
};

// it&#39;s important that both Android and iOS plugins have the same name
export const IonicNativePluginExample = registerPlugin&lt;NativePluginInterface&gt;(
  &quot;IonicNativePluginExample&quot;
);</code>
        </deckgo-highlight-code>
<p>Now we can call the methods in our plugin and access the native code:</p>
<deckgo-highlight-code language="jsx" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">import { IonicNativePluginExample } from &#39;./plugins/IonicNativePluginExample&#39;

...

// add a listener to native events which invokes some callback
IonicNativePluginExample.addListener(&quot;EVENT_LISTENER_NAME&quot;, ({ message }) =&gt;
    console.log(message);
);

// destructure the methods to call our native code from our non-native app
const { NativeMethod, NotifyListeners } = IonicNativePluginExample;

// native methods are asynchronous
const { message } = await NativeMethod();

// this method will trigger our event listener
NotifyListeners();</code>
        </deckgo-highlight-code>
<p><strong>Note: to see our changes reflected when we run the project natively, we need to run <code class="language-text">npx ionic build &amp;&amp; npx cap copy</code>.</strong></p>
<p>We now have a cross-platform app set up ready to write a native implementation. We run the same business logic from our Ionic app and get a different implementation for each device we run on.</p>
<p>I made a small edit to our Ionic project to create the simple implementation below - you can view the commit <a href="https://github.com/JamesDHW/IonicNativePlugin/commit/3652b264b287b5c909633e16532225e4293763cb">here</a>.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 740px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/4518537d6c25b12d55e5bc333d933094/50383/demo-app.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 102.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAADMklEQVQ4y4VVOU8bURB+JQgQLQUVNEgU3D+AX2AaCgSIAoFtCOlyNIA4EiSUE3E0lCRt0iThNlEUJJxEkSI5sY2TjY2xHfC+Xdu7vji+aCaxgSjYI32a2X3zvp15M29WrKysoKWlBU1NTWhubmadsxsbG9He3o7d3V1k0hkEDw4RDkegSR3RqISqalCjKqKEYxW6pkO0tbVBCFEQ/f39kKqGL66v+ObdRyB4iA+fPuPtu/dQ/AH4fihQAgdQFD9EQ0MDbyorK0NFRQVKSkpQWlqK8vJyVFZW8lpnZyece048ePgQjx4/xvj4OEbHxjA2No6ZmRncu3cfT54+xfraOkRXVxcCgQBCoRB0XWc7GAxCSolEIoEXL1/AZrVCkxoikQivEaLRKLLZLDKZDNLpNNvkIwYGBvilaZpIJpOMk5MTfibx+/2w2+2Ix+K4Ts7Pz1mTj+jr68Pe3h5WV1dZOxwOOJ1O7OzssJPH4wFloUnJz2dnZ0zwL0hiug7R09ODQpIjlKrMR3MdIUfY29ub/3IO5HB6epontNts+ZRpLedz9hc5wkQ8AdHd3V0wQrfbjSG7nZ2LSTweh7BarRwNVU3TNK60JqlJVWTSKXi9Xi6K8ZfQMAz4fD4chkJQfh5A8QchNf0iZZvNxiWnjeTo+67A5Q3gizuAYETH/v4+E5oJgzdRR6iqCj0Ww5E0EVZTiJvZqxH+T07PL6U8NATTMIumbCSMC8IrFeOD/1MUt8dzhbBQla8lpHWq5HWE/zZ1QcKcXBBepHy5ZS4j58uEg4ODfNWoMASyCXT4JC6Xi9smZSaLnmEqmYIYHh4u6EQDYeTGDcT1GLcMDQy652QTyM69o+spOjo6MDc3h8XFRSwsLLAmzM/PY3l5GXfu3sXNkRE8X3mGqqoqHrq1tbWor69n1NTUoLW1FdXV1bh96zZEXV1d0QHbYbHgp+LHq9dvsLntwNrGJja2thlr6xvY2nZgdX0DHz9+grBYLEUJR0dHuSjHNPalDqnFoGo6g22psaZfgaCbMDs7i8nJSUxNTWF6epo1YWJiAktLSzxss5ksIqEwjn4d5XF8yf4VjsA0DPwGpyBoeJi6BCYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Application demo"
        title="Application demo"
        src="/blog/static/4518537d6c25b12d55e5bc333d933094/50383/demo-app.png"
        srcset="/blog/static/4518537d6c25b12d55e5bc333d933094/772e8/demo-app.png 200w,
/blog/static/4518537d6c25b12d55e5bc333d933094/e17e5/demo-app.png 400w,
/blog/static/4518537d6c25b12d55e5bc333d933094/50383/demo-app.png 740w"
        sizes="(max-width: 740px) 100vw, 740px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h1>More complex plugins</h1>
<p>With the above setup, you should be ready to write more complex native code to suit your needs for a cross-platform Ionic application.</p>
<p>I wrote a native Plugin for Google's Nearby Messages API, which is a publish-subscribe API made by Google which facilitates the transfer of information between internet-connected Android and iOS devices.</p>
<p>Nearby Messages uses a combination of Bluetooth, Bluetooth Low Energy, Wi-Fi, and near-ultrasonic communication between nearby devices to create a unique pairing. This pairing is then used to send small payloads over the internet between nearby devices.</p>
<p>Here's a quick code snippet from the Android plugin:</p>
<deckgo-highlight-code language="java" terminal="carbon" theme="material" line-numbers="true"  >
          <code slot="code">...

import com.google.android.gms.nearby.Nearby;
import com.google.android.gms.nearby.messages.Message;
import com.google.android.gms.nearby.messages.MessageListener;

...

@NativePlugin()
public class NearbyMessagesPlugin extends Plugin {

		private Message mMessage;
    private MessageListener mMessageListener = new MessageListener() {
        @Override
        public void onFound(Message message) {
            JSObject result = new JSObject();
            result.put(&quot;message&quot;, new String (message.getContent()));
            notifyListeners(&quot;FOUND_MESSAGE&quot;, result);
        }

        @Override
        public void onLost(Message message) {
            JSObject result = new JSObject();
            result.put(&quot;message&quot;,  new String (message.getContent()));
            notifyListeners(&quot;LOST_MESSAGE&quot;, result);
        }
    };

    @PluginMethod
    public void Subscribe(PluginCall call){
        Nearby.getMessagesClient(getContext()).subscribe(mMessageListener);
    }

    @PluginMethod
    public void Publish(PluginCall call){
        String value = call.getString(&quot;message&quot;, &quot;-&quot;);
        mMessage = new Message(value.getBytes());
        Nearby.getMessagesClient(getContext()).publish(mMessage);
    }
}</code>
        </deckgo-highlight-code>
<p>Event listeners are appropriate here because although we don't know when/if the phone will pick up a Bluetooth signal, a side-effect can still be triggered in the business logic when it does. <code class="language-text">Subscribe</code> can be invoked to subscribe to <code class="language-text">mMessageListener</code> and listen for Bluetooth messages (or we could just call <code class="language-text">Subscribe</code> in the <code class="language-text">onCreate</code> of our native code if we wanted to).</p>
<h1>Summary</h1>
<p>Once you've got a simple implementation, you can move on and write some more complex native code.</p>
<p>If you want a quick-start, you can fork my <a href="https://github.com/JamesDHW/IonicNativePlugin">repository on GitHub</a>, but following along with the article and doing it yourself will really help your understanding.</p></div></div><div class="SiteLayoutstyle__Span-sc-17bo9rt-5 SiteLayoutstyle__Footer-sc-17bo9rt-6 cCEFpP bCEtmV"></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2021/07/writing-a-native-ionic-plugin-for-capacitor";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-8b4d9920bb81643e6f25.js"],"app":["/app-1314b861ed0bb07b6c47.js"],"component---src-pages-404-js":["/component---src-pages-404-js-625588f3ba724974f97a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-f69c49ca7309eab8caa9.js"],"component---src-templates-blog-post-blog-post-jsx":["/component---src-templates-blog-post-blog-post-jsx-cf647882aae575c41028.js"]};/*]]>*/</script><script src="/blog/polyfill-8b4d9920bb81643e6f25.js" nomodule=""></script><script src="/blog/component---src-templates-blog-post-blog-post-jsx-cf647882aae575c41028.js" async=""></script><script src="/blog/commons-58f96f9c41a01af360af.js" async=""></script><script src="/blog/6278397b-fef80d2a20efbbaf73b7.js" async=""></script><script src="/blog/app-1314b861ed0bb07b6c47.js" async=""></script><script src="/blog/framework-8dcaa89ad56a07169b97.js" async=""></script><script src="/blog/webpack-runtime-989660260a8f6f123648.js" async=""></script></body></html>